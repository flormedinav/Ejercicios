<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Presentacion de Vehículo</title>

    <!-- Importacion del jQuery -->
    <script src="js/lib/jquery-2.1.4.min.js"></script>

    <!-- Importacion del Bootstrap -->
    <link rel="stylesheet" href="css/bootstrap.min.css" />

    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body>
    <div class="container text-center">
      <h1>Objetos Prácticos: <small>Ejemplo de vehículo</small></h1>
      <hr />

      <div class="divPreloader">
        <img src="img/loading.gif" class="imgLoader img-responsive" />
      </div>

      <div class="divVistaPrevia">
        <img id="imgCarro" class="img-responsive" />
      </div>

      <div class="form-group">
        <div class="col-sm-offset-4 col-sm-5">
          <select id="cmbColor" class="form-control">
            <!-- <option value="blanco">Blanco</option>
            <option value="negro">Negro</option>
            <option value="rojo">Rojo</option> -->
          </select>
        </div>
      </div>
    </div>

    <script>
      (function () {
        // let testaView = {
        //   colores: ["blanco", "rojo", "cafe", "verde", "negro", "gris"],
        //   init: function (opciones) {

        //     for (let i = 0; i < testaView.colores.length; i++) {
        //       let color = testaView.colores[i];
        //       $("<option>", {
        //         value: color,
        //         text: color,
        //       }).appendTo("#cmbColor");
        //     }

        //     $("#cmbColor").on("change", function () {
        //       let color = $(this).val();
        //       let url = `img/tesla/modelS-${color}.jpg`;

        //       $("#imgCarro").attr("src", url);
        //     });
        //   },
        // };

        // testaView.init();

        let testaView = {
          loader: $(".divPreloader"),
          colores: ["blanco"],
          cambiarColor: function (img) {
            let ahora = new Date();
            console.log(ahora);

            let $loader = testaView.loader;
            $loader.fadeIn(150);

            if (!img) {
              let color = testaView.colores[0];
              img = `img/tesla/modelS-${color}.jpg`;
            }

            $("<img>", {
              src: img,
              class: "img-responsive",
            }).load(function () {
              let ahora = new Date();
              console.log(ahora);

              $(".divVistaPrevia").find("img").remove(); //Eliminamos imagen
              $(this).appendTo(".divVistaPrevia");

              $loader.fadeOut(150);
            });
          },
          init: function (opciones) {
            $.extend(testaView, opciones);

            for (let i = 0; i < testaView.colores.length; i++) {
              let color = testaView.colores[i];
              $("<option>", {
                value: color,
                text: color,
              }).appendTo("#cmbColor");
            }

            $("#cmbColor").on("change", function () {
              let color = $(this).val();
              let url = `img/tesla/modelS-${color}.jpg`;

              testaView.cambiarColor(url);
              // $("#imgCarro").attr("src", url);
            });

            testaView.cambiarColor();
          },
        };

        testaView.init({
          colores: ["rojo", "cafe", "verde", "negro", "gris"],
        });

        // $("#cmbColor").on("change", function () {
        //   let color = $(this).val();
        //   let url = `img/tesla/modelS-${color}.jpg`;

        //   $("#imgCarro").attr("src", url);
        // });
      })();
    </script>
  </body>
</html>
